<Page x:Class="Magpie.App.HomePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="using:Magpie.App"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
      mc:Ignorable="d">
	<local:PageFrame x:Uid="Home_PageFrame">
		<StackPanel HorizontalAlignment="Stretch"
		            Orientation="Vertical">
			<muxc:InfoBar Title="v0.10.0-preview1 可用"
			              Margin="0,8,0,14"
			              IsOpen="{x:Bind ViewModel.ShowUpdateCard, Mode=TwoWay}"
			              Severity="Informational"
			              Visibility="{x:Bind ViewModel.ShowUpdateCard, Mode=OneWay}">
				<StackPanel Margin="0,0,0,16"
				            Spacing="8">
					<CheckBox Content="自动检查更新"
					          IsChecked="{x:Bind ViewModel.IsAutoCheckForUpdates, Mode=TwoWay}" />
					<StackPanel Orientation="Horizontal"
					            Spacing="8">
						<Button Click="{x:Bind ViewModel.DownloadAndInstall}"
						        Content="下载并安装"
						        Style="{StaticResource AccentButtonStyle}" />
						<Button Click="{x:Bind ViewModel.ReleaseNotes}"
						        Content="发行说明" />
						<Button Click="{x:Bind ViewModel.RemindMeLater}"
						        Content="以后再提醒我" />
					</StackPanel>
				</StackPanel>
			</muxc:InfoBar>
			<local:SettingsGroup x:Uid="Home_Activation"
			                     Margin="0,-24,0,0">
				<local:SettingsCard x:Uid="Home_Activation_Hotkey">
					<local:SettingsCard.Icon>
						<FontIcon Glyph="&#xEDA7;" />
					</local:SettingsCard.Icon>
					<local:SettingsCard.ActionContent>
						<local:ShortcutControl Title="激活快捷键">
							<local:ShortcutControl.Action>
								<local:HotkeyAction>Scale</local:HotkeyAction>
							</local:ShortcutControl.Action>
						</local:ShortcutControl>
					</local:SettingsCard.ActionContent>
				</local:SettingsCard>
				<muxc:Expander HorizontalAlignment="Stretch"
				               HorizontalContentAlignment="Stretch"
				               Style="{StaticResource SettingExpanderStyle}">
					<muxc:Expander.Header>
						<local:SettingsCard x:Uid="Home_Stopwatch"
						                    Style="{StaticResource ExpanderHeaderSettingStyle}">
							<local:SettingsCard.Icon>
								<FontIcon Glyph="&#xE916;" />
							</local:SettingsCard.Icon>
							<local:SettingsCard.ActionContent>
								<StackPanel Orientation="Horizontal"
								            Spacing="5">
									<Grid Visibility="{x:Bind ViewModel.IsCountingDown, Mode=OneWay}">
										<muxc:ProgressRing Width="30"
										                   Height="30"
										                   FlowDirection="RightToLeft"
										                   IsActive="{x:Bind ViewModel.IsCountingDown, Mode=OneWay}"
										                   IsIndeterminate="False"
										                   Maximum="1"
										                   Minimum="0"
										                   Value="{x:Bind ViewModel.CountdownProgressRingValue, Mode=OneWay}" />
										<TextBlock Margin="0,-1,0,0"
										           HorizontalAlignment="Center"
										           VerticalAlignment="Center"
										           Text="{x:Bind ViewModel.CountdownLabelText, Mode=OneWay}" />
									</Grid>
									<Button Click="{x:Bind ViewModel.ToggleCountdown}"
									        Content="{x:Bind ViewModel.CountdownButtonText, Mode=OneWay}"
									        IsEnabled="{x:Bind ViewModel.IsNotRunning, Mode=OneWay}" />
								</StackPanel>
							</local:SettingsCard.ActionContent>
						</local:SettingsCard>
					</muxc:Expander.Header>
					<muxc:Expander.Content>
						<local:SettingsCard Title="倒计时时长"
						                    Style="{StaticResource ExpanderContentSettingStyle}">
							<local:SettingsCard.ActionContent>
								<Slider Width="150"
								        Maximum="5"
								        Minimum="1"
								        TickFrequency="1"
								        Value="{x:Bind ViewModel.DownCount, Mode=TwoWay}" />
							</local:SettingsCard.ActionContent>
						</local:SettingsCard>
					</muxc:Expander.Content>
				</muxc:Expander>
				<StackPanel Orientation="Vertical">
					<local:SettingsCard Title="记忆缩放窗口"
					                    Description="当该窗口回到前台时将自动缩放"
					                    Visibility="{x:Bind ViewModel.IsWndToRestore, Mode=OneWay, Converter={StaticResource NegativeVisibilityConverter}}">
						<local:SettingsCard.Icon>
							<FontIcon Glyph="&#xE944;" />
						</local:SettingsCard.Icon>
						<local:SettingsCard.ActionContent>
							<ToggleSwitch x:Uid="ToggleSwitch"
							              IsOn="{x:Bind ViewModel.IsAutoRestore, Mode=TwoWay}" />
						</local:SettingsCard.ActionContent>
					</local:SettingsCard>
					<muxc:Expander HorizontalAlignment="Stretch"
					               HorizontalContentAlignment="Stretch"
					               IsExpanded="{x:Bind ViewModel.IsWndToRestore, Mode=OneWay}"
					               Style="{StaticResource SettingExpanderStyle}"
					               Visibility="{x:Bind ViewModel.IsWndToRestore, Mode=OneWay}">
						<muxc:Expander.Header>
							<local:SettingsCard Title="记忆缩放窗口"
							                    Description="当该窗口回到前台时将自动缩放"
							                    Style="{StaticResource ExpanderHeaderSettingStyle}">
								<local:SettingsCard.Icon>
									<FontIcon Glyph="&#xE944;" />
								</local:SettingsCard.Icon>
								<local:SettingsCard.ActionContent>
									<ToggleSwitch x:Uid="ToggleSwitch"
									              IsOn="{x:Bind ViewModel.IsAutoRestore, Mode=TwoWay}" />
								</local:SettingsCard.ActionContent>
							</local:SettingsCard>
						</muxc:Expander.Header>
						<muxc:Expander.Content>
							<local:SettingsCard Title="{x:Bind ViewModel.RestoreWndDesc, Mode=OneWay}"
							                    Style="{StaticResource ExpanderContentSettingStyle}">
								<local:SettingsCard.ActionContent>
									<StackPanel Orientation="Horizontal"
									            Spacing="5">
										<Button Click="{x:Bind ViewModel.ActivateRestore}"
										        Content="激活"
										        Style="{StaticResource AccentButtonStyle}" />
										<Button Click="{x:Bind ViewModel.ClearRestore}"
										        Content="忘记" />
									</StackPanel>
								</local:SettingsCard.ActionContent>
							</local:SettingsCard>
						</muxc:Expander.Content>
					</muxc:Expander>
				</StackPanel>
			</local:SettingsGroup>
			<local:SettingsGroup Title="游戏内覆盖">
				<local:SettingsCard Title="快捷键"
				                    Description="自定义打开和关闭游戏内覆盖的快捷键">
					<local:SettingsCard.Icon>
						<FontIcon Glyph="&#xEDA7;" />
					</local:SettingsCard.Icon>
					<local:SettingsCard.ActionContent>
						<local:ShortcutControl Title="游戏内覆盖快捷键">
							<local:ShortcutControl.Action>
								<local:HotkeyAction>Overlay</local:HotkeyAction>
							</local:ShortcutControl.Action>
						</local:ShortcutControl>
					</local:SettingsCard.ActionContent>
				</local:SettingsCard>
			</local:SettingsGroup>
			<local:SettingsGroup Title="管理员模式">
				<muxc:Expander HorizontalAlignment="Stretch"
				               HorizontalContentAlignment="Stretch"
				               Style="{StaticResource SettingExpanderStyle}">
					<muxc:Expander.Header>
						<local:SettingsCard Title="管理员模式"
						                    Style="{StaticResource ExpanderHeaderSettingStyle}">
							<local:SettingsCard.Icon>
								<FontIcon Glyph="&#xE7EF;" />
							</local:SettingsCard.Icon>
							<local:SettingsCard.ActionContent>
								<Button Click="{x:Bind ViewModel.RestartAsElevated}"
								        Content="以管理员身份重启 Magpie"
								        IsEnabled="{x:Bind ViewModel.IsProcessElevated, Mode=OneTime, Converter={StaticResource NegationConverter}}" />
							</local:SettingsCard.ActionContent>
						</local:SettingsCard>
					</muxc:Expander.Header>
					<muxc:Expander.Content>
						<StackPanel Orientation="Vertical">
							<local:SettingsCard IsEnabled="{x:Bind ViewModel.IsProcessElevated, Mode=OneTime}"
							                    Style="{StaticResource ExpanderContentSettingStyle}">
								<CheckBox Content="始终以管理员身份运行"
								          IsChecked="{x:Bind ViewModel.IsAlwaysRunAsElevated, Mode=TwoWay}" />
							</local:SettingsCard>
							<muxc:InfoBar Title="以管理员身份重启 Magpie 以更改此设置"
							              IsClosable="False"
							              IsOpen="{x:Bind ViewModel.IsProcessElevated, Mode=OneTime, Converter={StaticResource NegationConverter}}"
							              Severity="Warning" />
						</StackPanel>
					</muxc:Expander.Content>
				</muxc:Expander>
			</local:SettingsGroup>
		</StackPanel>
	</local:PageFrame>
</Page>
