// (FSRCNNX_x2_8-0-4-1_LA) mapping 4_2


cbuffer constants : register(b0) {
	int2 srcSize : packoffset(c0.x);
};


#define MAGPIE_INPUT_COUNT 2
#include "common.hlsli"

#define get(i, pos) uncompressTan(SampleInput(i, pos))


D2D_PS_ENTRY(main) {
	InitMagpieSampleInput();

	float2 leftTop = GetCheckedOffPos(0, float2(-1, -1));
	float2 rightBottom = GetCheckedOffPos(0, float2(1, 1));

	float4 res = { -0.0836324766278267,0.0299216359853745,0.0159619841724634,-0.1379968672990799 };
	res += mul(get(0, leftTop), float4x4(-0.0837135538458824, 0.0536015741527081, -0.0739900916814804, 0.0180259179323912, 0.0306078922003508, 0.0638481751084328, -0.0674207285046577, -0.0308991391211748, -0.0134472101926804, -0.0455930270254612, 0.0009395828237757, -0.0776428431272507, -0.0028933393768966, -0.0612038075923920, -0.0162172410637140, -0.0327735245227814));
	res += mul(get(1, leftTop), float4x4(-0.1481152623891830, 0.1160185635089874, -0.1463897079229355, 0.0038319902960211, -0.1815536171197891, 0.0099428771063685, -0.1647379845380783, 0.0335076004266739, -0.0302220620214939, -0.1180571690201759, -0.0232424903661013, -0.0164348836988211, -0.0015188503311947, 0.1787684559822083, 0.0413909815251827, 0.0699580833315849));
	res += mul(get(0, float2(leftTop.x, Coord(0).y)), float4x4(0.0381213910877705, -1.8747351169586182, 0.0916024073958397, -0.1057635396718979, -0.1335459649562836, 0.0378836020827293, -0.0848037749528885, 0.1720509082078934, 0.1115766093134880, 0.0519676357507706, 0.1311796754598618, -0.2338305413722992, -0.0886595770716667, 0.1390771120786667, 0.0120587171986699, 0.0929709225893021));
	res += mul(get(1, float2(leftTop.x, Coord(0).y)), float4x4(-0.0403309725224972, 0.1023108437657356, -0.0249778237193823, -0.2056589871644974, 0.0864044427871704, 0.7677633166313171, 0.6112527251243591, -0.0935023576021194, 0.0358289442956448, -0.0510838404297829, 0.0531301461160183, -0.1200713515281677, -0.0281702410429716, 0.3054289221763611, -0.1970508396625519, 0.1440129280090332));
	res += mul(get(0, float2(leftTop.x, rightBottom.y)), float4x4(0.0137230604887009, 0.1833357512950897, -0.0056075016036630, -0.1050542071461678, 0.0367035493254662, 0.0896537080407143, -0.0109558179974556, -0.0221142154186964, -0.0462382063269615, -0.1151964291930199, -0.0042086942121387, 0.0297981910407543, 0.0043998458422720, 0.0687817037105560, -0.0601253211498260, 0.0031949516851455));
	res += mul(get(1, float2(leftTop.x, rightBottom.y)), float4x4(0.0760864540934563, 0.1863034367561340, 0.0503818355500698, -0.0258647575974464, -0.0760487392544746, 0.2433954179286957, -0.1973436474800110, 0.0079258847981691, -0.0294476337730885, -0.0404389686882496, -0.0294238775968552, 0.0358795709908009, 0.0298653114587069, 0.0783578902482986, 0.0419599078595638, 0.0248970054090023));
	res += mul(get(0, float2(Coord(0).x, leftTop.y)), float4x4(0.0907182395458221, 0.0576495565474033, 0.0530257523059845, 0.0549531430006027, 0.0915074944496155, -0.0465312339365482, -0.0230909585952759, -0.1178105399012566, -0.1995413154363632, -0.0433083362877369, -0.0418573357164860, 0.0866744294762611, -0.0793146342039108, 0.0074148247949779, 0.1731810569763184, 0.0715740397572517));
	res += mul(get(1, float2(Coord(0).x, leftTop.y)), float4x4(0.0023458630312234, 0.0404974594712257, -0.1356777399778366, 0.0418198816478252, -0.0675975754857063, 0.0050714882090688, 0.1104314029216766, -0.1206769123673439, -0.1913090348243713, 0.0773992761969566, 0.0560133233666420, -0.2490582764148712, 0.0971352458000183, 0.0728188008069992, 0.0192280132323503, 0.0784228071570396));
	res += mul(get(0, Coord(0).xy), float4x4(-0.0261659007519484, 0.1157309040427208, -0.3534074723720551, 0.5200188755989075, 0.1345363408327103, -0.1973183751106262, 0.1199645772576332, -1.1136766672134399, 0.1412540972232819, 0.1534357517957687, 0.2593606412410736, 0.3824510574340820, 0.5013928413391113, -0.1928857117891312, -0.2875523269176483, -0.0354673676192760));
	res += mul(get(1, Coord(0).xy), float4x4(0.1194906458258629, 0.1256935596466064, 0.0932049900293350, 0.1464174836874008, 0.0670514181256294, -0.1400509625673294, 0.1003381684422493, -0.1169824004173279, 0.2452844530344009, -0.0348181650042534, -0.3607256710529327, -0.3338264226913452, -0.0456272326409817, -0.0939910858869553, -0.1304696053266525, 0.0402086712419987));
	res += mul(get(0, float2(Coord(0).x, rightBottom.y)), float4x4(-0.0869473740458488, -0.1211445480585098, 0.0065225088037550, 0.0068075512535870, -0.1304764598608017, -0.0536689385771751, -0.1490984708070755, -0.0136555638164282, 0.1024399474263191, 0.0315260104835033, 0.0369606800377369, -0.0167442485690117, 0.0501606240868568, -0.0476666353642941, 0.0291139576584101, -0.0997947081923485));
	res += mul(get(1, float2(Coord(0).x, rightBottom.y)), float4x4(-0.0373449698090553, -0.0382255539298058, -0.1446493864059448, 0.0054460307583213, 0.0428361445665359, -0.2411493360996246, 0.0281034875661135, -0.1959404051303864, -0.0147660700604320, -0.0115446811541915, -0.0435077212750912, -0.0445765219628811, 0.0025869212113321, -0.0454641655087471, -0.0552970357239246, 0.0636689588427544));
	res += mul(get(0, float2(rightBottom.x, leftTop.y)), float4x4(0.0051982915028930, -0.0825250744819641, 0.0167135465890169, -0.1018612906336784, -0.0686964690685272, 0.0087886471301317, -0.0206265803426504, -0.0206072553992271, 0.0498707666993141, -0.0364030301570892, 0.0309015773236752, 0.0090340757742524, -0.0129618886858225, 0.0051486417651176, 0.0260841641575098, 0.0167939160019159));
	res += mul(get(1, float2(rightBottom.x, leftTop.y)), float4x4(0.0010780893499032, -0.0352349840104580, -0.0192162413150072, -0.0381371527910233, 0.0282760411500931, -0.0559629201889038, 0.0619673281908035, -0.0514238551259041, 0.0122259482741356, 0.0608348101377487, -0.0754647627472878, -0.1400517821311951, -0.0136043848469853, 0.0550616234540939, -0.0093750739470124, 0.0393888689577579));
	res += mul(get(0, float2(rightBottom.x, Coord(0).y)), float4x4(-0.1028572022914886, -0.0257119275629520, -0.0871436968445778, -0.2802977561950684, 0.1279940754175186, 0.0694741085171700, 0.0366430617868900, 0.1782210469245911, -0.0931140556931496, -0.1249292492866516, -0.0775476619601250, -0.3643486201763153, -0.1307956129312515, -0.0392269045114517, -0.0212084632366896, 0.0024634231813252));
	res += mul(get(1, float2(rightBottom.x, Coord(0).y)), float4x4(-0.0036887160968035, -0.0489760562777519, -0.0022769547067583, -0.0936355590820312, -0.0981694832444191, -0.0402673967182636, -0.0764046013355255, 0.0067043504677713, 0.0426195561885834, -0.0056512621231377, 0.0814872384071350, -0.0765113532543182, 0.0027868365868926, 0.0623648613691330, 0.0598746836185455, 0.1226531565189362));
	res += mul(get(0, rightBottom), float4x4(0.0350537523627281, 0.0229270569980145, 0.0465267412364483, -0.0452729463577271, 0.0256041418761015, 0.0215708781033754, -0.0193957649171352, -0.0173931997269392, 0.0231500957161188, -0.0499401167035103, 0.0173991154879332, -0.0804103761911392, -0.0232445765286684, -0.0107213268056512, 0.0450597628951073, 0.0691299363970757));
	res += mul(get(1, rightBottom), float4x4(0.0023379696067423, -0.0239015202969313, -0.0137971211224794, -0.0529763884842396, 0.0394022278487682, 0.0184435173869133, 0.0855478867888451, 0.0777183994650841, -0.0052624838426709, -0.0031146518886089, 0.0387042500078678, 0.0015482418239117, -0.0088084554299712, 0.0233839545398951, -0.0151950558647513, 0.0070519605651498));
	res = max(res, ZEROS4) + float4(0.7931001186370850, -0.0506631620228291, 0.3833878636360168, 0.3061273992061615) * min(res, ZEROS4);

	return compressTan(res);
}
