// (FSRCNNX_x2_8-0-4-1_LA) mapping 4_1


cbuffer constants : register(b0) {
	int2 srcSize : packoffset(c0.x);
};


#define MAGPIE_INPUT_COUNT 2
#include "common.hlsli"

#define get(i, pos) uncompressTan(SampleInput(i, pos))


D2D_PS_ENTRY(main) {
	InitMagpieSampleInput();

	float2 leftTop = GetCheckedOffPos(0, float2(-1, -1));
	float2 rightBottom = GetCheckedOffPos(0, float2(1, 1));

	float4 res = { -0.0466146245598793,0.0514914207160473,-0.1174036413431168,0.1775186359882355 };
	res += mul(get(0, leftTop), float4x4(0.0403013713657856, -0.0201274380087852, -0.0814156234264374, -0.0156530365347862, -0.1377502679824829, -0.0417905971407890, 0.0382207930088043, -0.1200272291898727, 0.0445257574319839, -0.0034040021710098, -0.1461200863122940, -0.0280020851641893, -0.0284179765731096, -0.0257030930370092, -0.0306571796536446, 0.0027001383714378));
	res += mul(get(1, leftTop), float4x4(0.0474935993552208, -0.1903701126575470, -0.5459222793579102, 0.0117317456752062, 0.1298255324363708, -0.1852943897247314, 0.0912317335605621, 0.0597700774669647, 0.0291008763015270, -0.0133294332772493, 0.2249753177165985, -0.1039957106113434, -0.0360252261161804, 0.0713268965482712, -0.1684121936559677, 0.0038015090394765));
	res += mul(get(0, float2(leftTop.x, Coord(0).y)), float4x4(0.1707874685525894, -0.0190297029912472, 0.0620337612926960, 0.1826018989086151, -0.0537132881581783, 0.0105489455163479, 0.0954312533140182, -0.0787296965718269, 0.1069839373230934, 0.1045138239860535, 0.1288910657167435, 0.0561389364302158, -0.0446831695735455, 0.0814650580286980, 0.0968160405755043, -0.0053927232511342));
	res += mul(get(1, float2(leftTop.x, Coord(0).y)), float4x4(-0.4036456644535065, 0.5173328518867493, 0.2669098377227783, 0.1405677497386932, 0.7028214335441589, 0.4912839531898499, 0.6029286384582520, 0.5650771260261536, 0.0271350406110287, 0.0700132623314857, -0.0723611563444138, -0.1151952818036079, -0.1905510127544403, -0.1715065985918045, 0.2840125858783722, -0.0591109022498131));
	res += mul(get(0, float2(leftTop.x, rightBottom.y)), float4x4(-0.0454136617481709, 0.0026271974202245, 0.0717174336314201, -0.0211183167994022, -0.0145919620990753, -0.0671255514025688, -0.0502023696899414, 0.0087185343727469, -0.0288616847246885, -0.0113478675484657, -0.2463355064392090, 0.0117223775014281, -0.0308947954326868, -0.0319634601473808, 0.0732206851243973, -0.0482302159070969));
	res += mul(get(1, float2(leftTop.x, rightBottom.y)), float4x4(0.1823509633541107, -0.0050594508647919, -0.3849277794361115, 0.0906973257660866, -0.2269264608621597, -0.1660439521074295, -0.0572436749935150, -0.2200210094451904, -0.0326488390564919, -0.0223822314292192, 0.2504203319549561, -0.0020041887182742, 0.0842133983969688, 0.0320363529026508, -0.2134571075439453, 0.0419851355254650));
	res += mul(get(0, float2(Coord(0).x, leftTop.y)), float4x4(-0.1438133865594864, 0.0348416790366173, 0.0934710800647736, 0.0492126196622849, -0.2420855760574341, 0.0501662716269493, 0.1352647244930267, -0.0790266394615173, 0.2533731162548065, 0.0078659672290087, -0.6405819058418274, 0.0266417451202869, 0.1385341882705688, 0.2193202823400497, -0.0242960918694735, 0.0509849824011326));
	res += mul(get(1, float2(Coord(0).x, leftTop.y)), float4x4(-0.1021846532821655, 0.0409118719398975, -0.0411306917667389, -0.0381408408284187, 0.3855873942375183, 0.0598353408277035, -0.0579320192337036, 0.0582632422447205, 0.1651727408170700, 0.1139431521296501, 0.3897903859615326, -0.2790665924549103, -0.2033874839544296, 0.0795733034610748, 0.1354800611734390, 0.0271498821675777));
	res += mul(get(0, Coord(0).xy), float4x4(0.5974506139755249, 0.2842084765434265, 0.2237064242362976, -0.1201776340603828, 0.4645690321922302, -0.4258180558681488, 0.2686293423175812, -0.5262981653213501, -0.6491079330444336, -0.1924646943807602, 0.5328685045242310, -0.2459655404090881, -0.0878667980432510, -0.5910828113555908, 0.5153566598892212, 0.1743167340755463));
	res += mul(get(1, Coord(0).xy), float4x4(-0.0390859283506870, 0.1246269494295120, 0.0820790305733681, -0.0892064496874809, 0.2791964113712311, -0.0395625308156013, 0.8821132779121399, 0.0838626548647881, 0.0933722704648972, -0.3405517935752869, -0.6993819475173950, -0.2844510078430176, 0.0422397889196873, -0.0712213888764381, 0.4871867001056671, 0.1554806381464005));
	res += mul(get(0, float2(Coord(0).x, rightBottom.y)), float4x4(-0.2699566185474396, 0.0006965834181756, 0.2727784812450409, -0.0620054267346859, -0.3147658407688141, -0.0038526458665729, 0.3236006200313568, -0.0877058431506157, 0.2106281071901321, 0.0453009121119976, -0.5439859628677368, 0.0184146761894226, -0.0296773612499237, -0.0038715677801520, 0.1077574864029884, 0.0138774076476693));
	res += mul(get(1, float2(Coord(0).x, rightBottom.y)), float4x4(-0.0886235535144806, -0.0839715227484703, -0.1154380440711975, -0.0073053352534771, 0.0023921213578433, -0.0275820419192314, 0.0455723628401756, 0.0129091050475836, -0.0887900739908218, -0.0148513885214925, 0.0876928195357323, -0.0784894824028015, -0.0062762177549303, -0.0526834838092327, 0.0037576633039862, 0.0319633670151234));
	res += mul(get(0, float2(rightBottom.x, leftTop.y)), float4x4(-0.0464110672473907, 0.0236346330493689, 0.0669583231210709, -0.0472575165331364, 0.0208626259118319, -0.0271043106913567, -0.0606599785387516, -0.0139442197978497, -0.0014815550530329, 0.0122182741761208, 0.0004507199628279, 0.0158279109746218, 0.0385761559009552, 0.0296174921095371, -0.0291853323578835, 0.0165338683873415));
	res += mul(get(1, float2(rightBottom.x, leftTop.y)), float4x4(-0.0233153514564037, 0.0219305511564016, -0.0743728205561638, -0.0093567697331309, 0.0286262184381485, 0.0774424001574516, 0.1148394867777824, -0.0301702339202166, 0.0024869549088180, -0.0374004244804382, 0.4192572534084320, -0.0790813118219376, -0.0493366643786430, -0.0104152699932456, -0.0490021072328091, -0.0024766430724412));
	res += mul(get(0, float2(rightBottom.x, Coord(0).y)), float4x4(0.0144469039514661, -0.1078102141618729, 0.1059413179755211, -0.1089596152305603, 0.0470409952104092, 0.0500787831842899, -0.0514846295118332, 0.0626327991485596, -0.0882258489727974, 0.0321751609444618, 0.2398201376199722, -0.2443147897720337, 0.0259658545255661, -0.0396602302789688, 0.2174025326967239, 0.0715249925851822));
	res += mul(get(1, float2(rightBottom.x, Coord(0).y)), float4x4(-0.0154824554920197, 0.0291374288499355, 0.0039887567982078, -0.0431501194834709, 0.0593536123633385, -0.0845754146575928, 0.2000104188919067, 0.0186260938644409, 0.0547599084675312, 0.0526885949075222, -0.1233010515570641, -0.0432526804506779, 0.0357321202754974, 0.0021650493144989, 0.0814491733908653, 0.0971980616450310));
	res += mul(get(0, rightBottom), float4x4(0.0287933535873890, 0.0494442507624626, 0.0210838094353676, -0.0483787320554256, -0.0759167149662971, -0.0253081526607275, 0.1219362914562225, -0.0418672412633896, -0.0189503412693739, 0.0143473483622074, -0.1790502667427063, -0.0662427768111229, 0.0324281528592110, 0.0148597611114383, 0.0266743116080761, 0.0377049185335636));
	res += mul(get(1, rightBottom), float4x4(-0.0054656565189362, -0.0150196319445968, -0.0463149808347225, -0.0104772448539734, 0.0347928367555141, 0.0091987038031220, 0.0037015024572611, 0.0577751062810421, 0.0232732165604830, 0.0034828644711524, 0.0977631732821465, -0.0051266341470182, -0.0189268663525581, -0.0049852686934173, 0.0438088737428188, -0.0025434335693717));
	res = max(res, ZEROS4) + float4(0.2930726408958435, -0.7832366824150085, 0.0082256151363254, 1.0583437681198120) * min(res, ZEROS4);

	return compressTan(res);
}
