// (FSRCNNX_x2_8-0-4-1) mapping 3_1


cbuffer constants : register(b0) {
	int2 srcSize : packoffset(c0.x);
};


#define MAGPIE_INPUT_COUNT 2
#include "FSRCNNX8041.hlsli"


#define get(i, pos) uncompressTan(SampleInput(i, pos))


D2D_PS_ENTRY(main) {
	InitMagpieSampleInput();

	float2 leftTop = GetCheckedOffPos(0, float2(-1, -1));
	float2 rightBottom = GetCheckedOffPos(0, float2(1, 1));

	float4 res = { -0.0410279631614685,-0.1111723631620407,-0.0406232848763466,-0.0939496159553528 };
	res += mul(get(0, leftTop), float4x4(0.1221675798296928, 0.0083215842023492, -0.0162804014980793, 0.0316714197397232, -0.2205813378095627, 0.1500435769557953, 0.2109555304050446, 0.2741867899894714, 0.0956874340772629, -0.0896854698657990, -0.1657065600156784, -0.1349759399890900, 0.0601499564945698, -0.1523845940828323, -0.1828087568283081, -0.2727653682231903));
	res += mul(get(1, leftTop), float4x4(-0.0918163508176804, 0.1564485579729080, 0.1133174449205399, 0.2215953171253204, -0.0623677000403404, -0.0497728772461414, -0.0372809022665024, -0.0258478187024593, -0.1364922970533371, 0.1053884625434875, 0.3292874991893768, 0.2693256139755249, -0.0347631797194481, -0.1470523178577423, 0.0096792401745915, -0.0542853325605392));
	res += mul(get(0, float2(leftTop.x, Coord(0).y)), float4x4(0.1331177949905396, -0.0964357852935791, -0.0706946700811386, 0.1593225002288818, -0.4815943241119385, 0.1224092170596123, -0.0870430991053581, 0.0005010276800022, -0.0242684502154589, -0.2256436049938202, 0.1367238312959671, 0.0474774017930031, 0.6886650323867798, -0.0065326127223670, 0.1841574758291245, -0.1354993879795074));
	res += mul(get(1, float2(leftTop.x, Coord(0).y)), float4x4(-0.1049591675400734, 0.0515934228897095, 0.1128631457686424, 0.1688040047883987, -0.0084041170775890, -0.0006375144002959, -0.0598374009132385, 0.1424416452646255, -0.0048398924991488, 0.1832167655229568, 0.0231959503144026, 0.0816788375377655, -0.1321710795164108, 0.0397678017616272, -0.0058345394209027, 0.5784573554992676));
	res += mul(get(0, float2(leftTop.x, rightBottom.y)), float4x4(0.1438693851232529, -0.0694608166813850, -0.0428275354206562, 0.1599996536970139, -0.1651254445314407, 0.1388883888721466, -0.0895452573895454, 0.2569831907749176, 0.3150432109832764, -0.0910519883036613, 0.0367441214621067, 0.1903669685125351, 0.2805841267108917, -0.0444608181715012, 0.0059385276399553, -0.2585869431495667));
	res += mul(get(1, float2(leftTop.x, rightBottom.y)), float4x4(-0.1217494234442711, 0.0191769022494555, -0.0065453462302685, 0.1391217857599258, 0.0998920649290085, -0.0162798929959536, 0.0502282194793224, 0.0370145924389362, 0.0290782172232866, -0.0099554909393191, 0.0142515478655696, 0.1248661577701569, -0.0076912571676075, 0.0251651499420404, 0.2190572917461395, 0.0020069130696356));
	res += mul(get(0, float2(Coord(0).x, leftTop.y)), float4x4(0.2666685581207275, -0.1625511497259140, -0.3938800692558289, -0.0253848694264889, 0.0987015441060066, 0.2033616453409195, 0.3128099143505096, 0.4608893990516663, 0.0620003379881382, -0.1389972567558289, -0.3095863461494446, -0.4023511111736298, -0.1105777546763420, 0.1115406602621078, 0.3639950752258301, 0.0645622834563255));
	res += mul(get(1, float2(Coord(0).x, leftTop.y)), float4x4(-0.2135885655879974, -0.1035343706607819, 0.1795026361942291, 0.1828210204839706, 0.0780984908342361, 0.0656728670001030, 0.0033678691834211, 0.1361345648765564, 0.1712654232978821, -0.0172833092510700, -0.0502183400094509, 0.2910411655902863, 0.0691247656941414, 0.1935720741748810, 0.0652214139699936, 0.1608240753412247));
	res += mul(get(0, Coord(0).xy), float4x4(0.8243460655212402, -0.0979344248771667, -0.0366373993456364, 0.1692261099815369, 0.5517869591712952, 0.3282494544982910, -0.7905511856079102, -0.4462923705577850, -0.0803156569600105, 0.1172509342432022, 0.1864327639341354, 0.1471016854047775, 0.1296005547046661, -0.1004103720188141, 0.3174172043800354, -0.1181766316294670));
	res += mul(get(1, Coord(0).xy), float4x4(0.0259374529123306, -0.0934808850288391, 0.3008874654769897, 0.3957927823066711, -0.4048821926116943, 0.1461934000253677, -0.1819096356630325, -0.1908810287714005, 0.3193186521530151, -0.7438099980354309, 0.1919509470462799, -0.2065188735723495, 0.1752236187458038, -0.6840037107467651, 0.1588519066572189, -0.3956064879894257));
	res += mul(get(0, float2(Coord(0).x, rightBottom.y)), float4x4(0.1574442386627197, -0.0114925103262067, -0.1208277940750122, 0.2058266401290894, 0.2879209220409393, -0.0419875606894493, -0.1902059614658356, -0.2723863720893860, -0.1086223348975182, -0.0870924964547157, 0.8605937957763672, 0.2656622231006622, -0.1653763055801392, 0.0816384851932526, -0.0137870563194156, 0.1433854848146439));
	res += mul(get(1, float2(Coord(0).x, rightBottom.y)), float4x4(-0.1565909236669540, -0.0307490080595016, -0.1055604666471481, 0.2573592662811279, -0.1186821162700653, 0.1141471788287163, -0.0272745657712221, -0.1049114838242531, 0.2445316016674042, -0.0027864547446370, -0.1759569346904755, -0.1556979566812515, 0.0550616309046745, 0.1704383641481400, 0.0853662937879562, 0.3280856907367706));
	res += mul(get(0, float2(rightBottom.x, leftTop.y)), float4x4(0.1460669338703156, 0.4202052652835846, -0.3638312816619873, -0.0958623066544533, -0.0492525361478329, -0.3664234280586243, 0.0794373303651810, 0.0399017669260502, 0.0629198029637337, 0.1662959158420563, -0.1001493930816650, -0.0587460733950138, -0.0396478697657585, 0.0017320754704997, 0.0314909480512142, -0.0202700830996037));
	res += mul(get(1, float2(rightBottom.x, leftTop.y)), float4x4(-0.0964399129152298, 0.0380319654941559, 0.0396055467426777, 0.0265473183244467, -0.0161637403070927, -0.1872924566268921, 0.1670000404119492, 0.0029466480482370, -0.1093841269612312, -0.3629201948642731, -0.0562992505729198, 0.1792684197425842, -0.0203859098255634, 0.0983991250395775, 0.0058611719869077, 0.1627455651760101));
	res += mul(get(0, float2(rightBottom.x, Coord(0).y)), float4x4(-0.1117974221706390, 0.7562329173088074, -0.2046248912811279, 0.1677842289209366, -0.2063486129045486, -0.6023545265197754, -0.5739209651947021, 0.5110496878623962, -0.0715268924832344, -0.1373793482780457, 0.1251420378684998, -0.0477442294359207, 0.4961377978324890, 0.2688887119293213, 0.3146316707134247, -0.5197153687477112));
	res += mul(get(1, float2(rightBottom.x, Coord(0).y)), float4x4(-0.1314805448055267, 0.0746279135346413, 0.3457699418067932, 0.2564856410026550, 0.0839370116591454, -0.6136511564254761, -0.4646295011043549, 0.0612256154417992, -0.1910563558340073, -0.0935136750340462, -0.2426030039787292, 0.2102959007024765, 0.1575350016355515, 0.6145061254501343, 0.3368154168128967, -0.0974092856049538));
	res += mul(get(0, rightBottom), float4x4(0.0565315335988998, 0.2393359094858170, -0.0932938233017921, 0.1555283814668655, 0.0123879108577967, -0.1247719228267670, -0.0564610138535500, -0.1125799044966698, -0.0104600470513105, 0.0482629500329494, 0.2316472232341766, 0.1083717569708824, -0.0525921434164047, 0.0643989592790604, -0.0525734610855579, -0.0503251366317272));
	res += mul(get(1, rightBottom), float4x4(-0.1835366338491440, 0.0978360474109650, -0.1111819595098495, 0.2109299153089523, 0.0509372949600220, -0.1992686837911606, 0.0677929744124413, -0.0870024710893631, -0.0412262082099915, -0.0697719156742096, -0.0967373847961426, 0.0137308547273278, 0.0195730421692133, 0.0410240143537521, 0.1157210171222687, 0.2283479571342468));
	res = max(res, ZEROS4) + float4(0.1991519331932068, -0.1275756657123566, -0.0622864030301571, 0.1586369574069977) * min(res, ZEROS4);

	return compressTan(res);
}
