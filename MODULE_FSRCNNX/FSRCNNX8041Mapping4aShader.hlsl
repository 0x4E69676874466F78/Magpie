// (FSRCNNX_x2_8-0-4-1) mapping 4_1


cbuffer constants : register(b0) {
	int2 srcSize : packoffset(c0.x);
};


#define MAGPIE_INPUT_COUNT 2
#include "FSRCNNX8041.hlsli"

#define get(i, pos) uncompressTan(SampleInput(i, pos))


D2D_PS_ENTRY(main) {
	InitMagpieSampleInput();

	float2 leftTop = GetCheckedOffPos(0, float2(-1, -1));
	float2 rightBottom = GetCheckedOffPos(0, float2(1, 1));

	float4 res = { -0.1306160986423492,-0.0808217376470566,-0.2880123555660248,0.0099629526957870 };
	res += mul(get(0, leftTop), float4x4(-0.1033539846539497, 0.0541300140321255, -0.0804840475320816, -0.0334571413695812, -0.0264753755182028, 0.1118840202689171, 0.1186013221740723, -0.0127575425431132, 0.2236593365669250, 0.0025286162272096, 0.0985530614852905, 0.0685181617736816, -0.1884875595569611, 0.0530862808227539, -0.0482063069939613, 0.0375233069062233));
	res += mul(get(1, leftTop), float4x4(0.1837068796157837, -0.0632847175002098, 0.0016613919287920, 0.0392861217260361, 0.2923883199691772, -0.1713902205228806, 0.1907587945461273, 0.0550456829369068, 0.0644215345382690, -0.1046456992626190, 0.0187383033335209, 0.0770180150866508, 0.1933846622705460, -0.0455715768039227, 0.0375007353723049, -0.1053109914064407));
	res += mul(get(0, float2(leftTop.x, Coord(0).y)), float4x4(-0.0972480997443199, 0.2820451855659485, 0.0114549007266760, -0.0954328626394272, 0.0706252008676529, 0.4829064607620239, -0.6371517181396484, 0.0005180989392102, 0.3280143439769745, 0.0665246024727821, -0.0503116399049759, -0.1261110603809357, 0.1114177703857422, -0.2053108513355255, 0.1428771317005157, 0.3926100134849548));
	res += mul(get(1, float2(leftTop.x, Coord(0).y)), float4x4(-0.2571723163127899, 0.1627264618873596, -0.4940335154533386, -0.1361546218395233, 0.0804422944784164, -0.4231885373592377, 0.0650202706456184, 0.0518481098115444, -0.0502478554844856, -0.1305799931287766, 0.1814480125904083, 0.0090866927057505, -0.0510044656693935, -0.1691461503505707, 0.0922467112541199, -0.0314207412302494));
	res += mul(get(0, float2(leftTop.x, rightBottom.y)), float4x4(0.1270498335361481, 0.0563284493982792, -0.0435525141656399, 0.1569847911596298, 0.0576847903430462, 0.3461692929267883, -0.0325655154883862, -0.2688976824283600, -0.1341977864503860, -0.1382253766059875, 0.2293784171342850, -0.1111817285418510, -0.1402447521686554, -0.3257531225681305, 0.0598510466516018, 0.1008039116859436));
	res += mul(get(1, float2(leftTop.x, rightBottom.y)), float4x4(0.1698816716670990, 0.3491003513336182, -0.1367681026458740, -0.1165873408317566, -0.2091718912124634, -0.1487034261226654, -0.0569749698042870, -0.2100717276334763, 0.0404917001724243, -0.1372035890817642, 0.0689046755433083, -0.0367818064987659, -0.0325474888086319, -0.0114965448155999, -0.0137249026447535, -0.0279692262411118));
	res += mul(get(0, float2(Coord(0).x, leftTop.y)), float4x4(-0.0563433989882469, 0.0132494345307350, -0.2434540390968323, 0.0796563774347305, -0.2109155058860779, 0.0387088693678379, -0.0591037571430206, 0.0955820381641388, 0.4660535752773285, -0.1204202473163605, 0.1332369595766068, -0.0285425651818514, -0.3886952698230743, -0.0434980578720570, -0.0849134400486946, 0.0802380964159966));
	res += mul(get(1, float2(Coord(0).x, leftTop.y)), float4x4(0.0412235632538795, 0.1571959257125854, 0.2050069272518158, -0.1138664111495018, 0.1962715685367584, 0.0594439841806889, 0.0351715497672558, -0.0129811102524400, 0.2055217623710632, -0.0647534057497978, 0.0373471938073635, 0.0877277255058289, -0.5734645724296570, 0.1188675239682198, -0.1145943328738213, -0.1182733029127121));
	res += mul(get(0, Coord(0).xy), float4x4(-0.2004909217357635, -0.4817073047161102, 0.5596802830696106, -0.0327854752540588, 0.0989314392209053, 0.4127818942070007, 0.7265836596488953, -0.2692042589187622, 0.5195841789245605, -0.2357539832592010, -0.3819393217563629, 0.1755530238151550, 0.6578183770179749, 0.1075539961457253, -0.2688144743442535, 0.3242723941802979));
	res += mul(get(1, Coord(0).xy), float4x4(-0.3221310675144196, 0.2978510260581970, 0.2269985526800156, -0.3184116482734680, 0.4845580160617828, 0.4407236874103546, 0.0099756307899952, -0.3121858239173889, -0.3810067176818848, -0.0553649961948395, 0.0202834140509367, 0.0409953594207764, 0.2532750964164734, 0.2731618583202362, 0.1237529441714287, 0.0134243080392480));
	res += mul(get(0, float2(Coord(0).x, rightBottom.y)), float4x4(0.1835541725158691, 0.0549701862037182, -0.1749316602945328, -0.2030028849840164, 0.0263462308794260, 0.2781440317630768, 0.0372458845376968, 0.3643021881580353, -0.4047883749008179, 0.0660117194056511, 0.4863115549087524, -0.2024163603782654, -0.6403482556343079, 0.2765505611896515, 0.1417075097560883, 0.5064445734024048));
	res += mul(get(1, float2(Coord(0).x, rightBottom.y)), float4x4(0.6106975078582764, -0.1570862233638763, -0.3223383128643036, -0.2497926801443100, -0.4854303300380707, 0.0132978223264217, -0.0609334111213684, 0.1285556703805923, -0.1412864029407501, -0.1379042416810989, -0.0258826259523630, 0.1357705891132355, -0.1285902857780457, -0.0577826797962189, 0.0550044551491737, 0.1717510819435120));
	res += mul(get(0, float2(rightBottom.x, leftTop.y)), float4x4(0.1389609426259995, 0.0835867226123810, 0.0309768319129944, -0.0278116948902607, -0.0390677824616432, -0.0111810686066747, -0.0025318188127130, 0.0069569633342326, 0.0347319357097149, 0.0191543344408274, 0.0314339138567448, -0.0228427499532700, 0.0416300334036350, 0.0249234102666378, 0.1210031509399414, 0.1142473593354225));
	res += mul(get(1, float2(rightBottom.x, leftTop.y)), float4x4(0.0607251487672329, 0.0386395826935768, -0.0219341218471527, -0.1102298423647881, 0.1487188935279846, 0.0602982006967068, -0.0280748903751373, -0.0211924221366644, 0.0042894422076643, -0.0269144997000694, 0.0814756453037262, -0.0314031280577183, -0.0213186051696539, -0.1362965404987335, 0.0382767543196678, -0.0669511556625366));
	res += mul(get(0, float2(rightBottom.x, Coord(0).y)), float4x4(-0.2397561967372894, 0.3023172020912170, -0.2398054003715515, 0.0041919997893274, -0.1016605198383331, -0.1521034836769104, -0.1526568531990051, 0.0272433310747147, 0.0741761848330498, 0.1116370111703873, 0.1149727106094360, -0.0809784531593323, -0.1448147594928741, -0.0943927690386772, -0.0086280042305589, 0.1243222951889038));
	res += mul(get(1, float2(rightBottom.x, Coord(0).y)), float4x4(-0.0469366572797298, -0.1655988991260529, -0.1029584184288979, -0.1347874104976654, 0.2064601778984070, 0.0521226711571217, -0.1366733759641647, -0.0041872998699546, 0.1077186539769173, 0.0184442866593599, -0.2309073060750961, -0.1637075096368790, -0.0417953692376614, -0.3190860450267792, -0.1593534499406815, 0.0136412177234888));
	res += mul(get(0, rightBottom), float4x4(0.1698798984289169, 0.0232755411416292, -0.0876034423708916, -0.3008348643779755, 0.0789884999394417, 0.0034748215693980, -0.0064704762771726, 0.0057828431017697, -0.0190630126744509, -0.0334153175354004, -0.0195646341890097, 0.0105131156742573, 0.0995147302746773, -0.3130289018154144, -0.0724022984504700, 0.0113303456455469));
	res += mul(get(1, rightBottom), float4x4(-0.0027791252359748, -0.0193455871194601, -0.0415000133216381, 0.0568981170654297, -0.2745247483253479, 0.1222846284508705, 0.1899162530899048, 0.1067754998803139, -0.0561975166201591, -0.1500336527824402, 0.0526139959692955, -0.3491798937320709, -0.0692384615540504, -0.0307095069438219, 0.0498757846653461, 0.0019003645284101));
	res = max(res, ZEROS4) + float4(0.1552927196025848, 0.0782765746116638, 0.7966942191123962, -1.1619627475738525) * min(res, ZEROS4);

	return compressTan(res);
}
