// (FSRCNNX_x2_8-0-4-1_LA) mapping 1_2


cbuffer constants : register(b0) {
	int2 srcSize : packoffset(c0.x);
};


#define MAGPIE_INPUT_COUNT 2
#include "common.hlsli"

#define get0(pos) uncompressLinear(SampleInput(0, pos), -1, 1.5)
#define get1(pos) uncompressLinear(SampleInput(1, pos), -1, 1)


D2D_PS_ENTRY(main) {
	InitMagpieSampleInput();

	float2 leftTop = GetCheckedOffPos(0, float2(-1, -1));
	float2 rightBottom = GetCheckedOffPos(0, float2(1, 1));

	float4 res = { 0.0170604288578033,-0.0097856530919671,0.0882583037018776,0.0158541873097420 };
	res += mul(get0(leftTop), float4x4(0.1967887729406357, -0.0514578297734261, 0.0351365692913532, -0.0027727256529033, 0.0978068783879280, -0.3902593851089478, 0.0123964082449675, -0.1210777312517166, 0.3820665776729584, -0.5003674030303955, 0.0546922460198402, -0.0777103230357170, 0.9743819236755371, -0.3239430189132690, -0.2496883124113083, 0.1733392328023911));
	res += mul(get1(leftTop), float4x4(-0.1924884468317032, 0.5075340867042542, -0.0542841143906116, 0.0434595011174679, 0.1881206482648849, -0.1774751842021942, -0.1752865165472031, 0.0315622761845589, -0.4268247485160828, 0.3984751403331757, -0.0704891532659531, -0.0969574451446533, 0.1777588576078415, 0.2743588685989380, -0.0317226983606815, -0.1993683725595474));
	res += mul(get0(float2(leftTop.x, Coord(0).y)), float4x4(-0.1353080570697784, -0.0161478724330664, 0.0713945776224136, 0.1482806354761124, -0.0025943452492356, -0.0296892002224922, 0.1426411569118500, 0.3263220191001892, 0.3354269266128540, -0.0851829424500465, 0.1781585812568665, -0.0421005003154278, -0.5350970029830933, -1.3111218214035034, 0.2340501397848129, -0.9513134956359863));
	res += mul(get1(float2(leftTop.x, Coord(0).y)), float4x4(-0.0965117588639259, -0.3247327506542206, 0.1102668121457100, -0.1604842394590378, 0.4602060914039612, 0.0756718367338181, -0.3309438228607178, -0.3001569509506226, 0.2267884165048599, 0.1377216577529907, -0.0426548905670643, 0.1272846758365631, -0.1080727055668831, -0.4640344679355621, -0.3294694125652313, -0.2043451815843582));
	res += mul(get0(float2(leftTop.x, rightBottom.y)), float4x4(0.0720937326550484, -0.1846759617328644, -0.1708657741546631, -0.0725364983081818, 0.1260499358177185, -0.1162428930401802, -0.2501497566699982, -0.1012131050229073, 0.2760527133941650, -0.0939920768141747, 0.2875119149684906, 0.0406376719474792, 0.1008657962083817, -0.1240409687161446, -0.4121425449848175, 0.3269978761672974));
	res += mul(get1(float2(leftTop.x, rightBottom.y)), float4x4(0.0125542022287846, 0.2582587003707886, 0.1726561784744263, 0.0180624593049288, 0.0579377673566341, -0.0663961246609688, -0.0078865075483918, -0.0506187379360199, -0.0882500410079956, -0.0282228980213404, -0.1616529822349548, -0.1816279888153076, 0.1482390761375427, -0.3260181546211243, 0.1757252663373947, 0.1394872069358826));
	res += mul(get0(float2(Coord(0).x, leftTop.y)), float4x4(-0.0768914818763733, -0.1610976904630661, -0.0581125281751156, 0.1043644994497299, -0.0832794085144997, 0.1854220479726791, -0.0097211552783847, 0.2851990759372711, -0.6227292418479919, -0.2649715840816498, 0.4023403823375702, -0.2051993161439896, 0.4956052303314209, 0.8367735743522644, 0.2145122885704041, 0.3317213356494904));
	res += mul(get1(float2(Coord(0).x, leftTop.y)), float4x4(0.9697892665863037, -0.2038540095090866, -0.3166446983814240, -0.0504710040986538, 0.1532189846038818, 0.3050784170627594, -0.1300316900014877, -0.2059933692216873, 0.4894859492778778, -0.3882815837860107, -0.7273328304290771, 0.3463444113731384, -0.8791087865829468, -0.2762917280197144, -0.2789021134376526, -0.1907687485218048));
	res += mul(get0(Coord(0).xy), float4x4(0.1201086342334747, 0.1047629937529564, -0.3030976653099060, 0.0362001918256283, -0.2728919386863708, -0.5267004966735840, 0.1090360283851624, -0.2792145609855652, -0.3083780109882355, 0.2616442143917084, 0.4801669716835022, 0.1518263220787048, -1.6350433826446533, 0.7567611336708069, -1.9801075458526611, 1.1116229295730591));
	res += mul(get1(Coord(0).xy), float4x4(-0.6893532276153564, -0.3531652688980103, -0.1891958266496658, 1.7840391397476196, 1.4943064451217651, 0.7292221188545227, -1.7417374849319458, 0.0550648272037506, -0.1120251268148422, 0.8250336647033691, 1.1355321407318115, -1.1124770641326904, -0.2689424455165863, 0.9269363284111023, 1.9637582302093506, -0.3709079027175903));
	res += mul(get0(float2(Coord(0).x, rightBottom.y)), float4x4(-0.0544882826507092, -0.1718381494283676, -0.1280352175235748, 0.1454906165599823, -0.1176344379782677, 0.0151336872950196, -0.2567785680294037, 0.2511477768421173, 0.3610197603702545, 0.5843607783317566, 0.0848828330636024, 0.1415835469961166, 0.4969498217105865, 0.5772764682769775, 0.5247990489006042, -0.0598939247429371));
	res += mul(get1(float2(Coord(0).x, rightBottom.y)), float4x4(0.0529166162014008, -0.1535185724496841, -0.1523050367832184, -0.0501741841435432, -0.0633302107453346, -0.3949260413646698, 0.1972121149301529, -0.2604303061962128, -0.1828030794858932, 0.2246686667203903, -0.6004081368446350, 0.0432657450437546, -0.2086566388607025, 0.2799777686595917, 0.2933793962001801, -0.0253354366868734));
	res += mul(get0(float2(rightBottom.x, leftTop.y)), float4x4(-0.0009011612855829, -0.0231834072619677, -0.0538895800709724, -0.0315926298499107, -0.1181581020355225, -0.2161513417959213, -0.2679739892482758, -0.0537310577929020, 0.3116895258426666, -0.1043426766991615, -0.4458046257495880, 0.0201701205223799, -0.8122410774230957, -0.5180496573448181, -0.1277437359094620, -0.1671603769063950));
	res += mul(get1(float2(rightBottom.x, leftTop.y)), float4x4(0.2782520055770874, 0.2888738214969635, 0.2265798002481461, 0.0807978361845016, -0.1869603991508484, -0.2283953428268433, -0.4374879896640778, 0.2510242760181427, 0.4857149720191956, -0.1796883046627045, 0.2519723176956177, 0.1950220316648483, -0.0102280136197805, -0.4034306704998016, -0.2963733077049255, 0.4622495174407959));
	res += mul(get0(float2(rightBottom.x, Coord(0).y)), float4x4(0.0423482730984688, -0.2923308312892914, -0.0082442639395595, 0.2373020350933075, 0.1710588335990906, 0.0392467305064201, 0.0116449045017362, 0.3267012536525726, -0.8832122683525085, 0.7230877280235291, -0.2364437282085419, -0.5563997030258179, 0.2307662665843964, -1.0188170671463013, 0.3680693507194519, -0.8103905916213989));
	res += mul(get1(float2(rightBottom.x, Coord(0).y)), float4x4(-0.1161488518118858, -0.6775091290473938, -0.0844684988260269, -0.3587656021118164, -0.0190705843269825, -0.5557464957237244, 0.3721883893013000, 0.1322396695613861, -0.1157554760575294, -0.1545359939336777, 0.4236145615577698, -0.9936751127243042, -0.0805041715502739, -0.2628504335880280, 0.1407603323459625, -0.4183281958103180));
	res += mul(get0(rightBottom), float4x4(-0.0447837486863136, 0.0488513521850109, -0.1358503550291061, 0.0202376656234264, -0.0258089359849691, -0.2975459396839142, -0.1580457836389542, 0.1025377139449120, -0.0301857776939869, -0.1071514338254929, -0.0150549048557878, 0.0794499814510345, 0.4558653235435486, 0.8186704516410828, 0.2287982851266861, -0.1438317447900772));
	res += mul(get1(rightBottom), float4x4(0.1536326855421066, 0.2366072386503220, 0.0591898001730442, -0.0547822229564190, 0.1068296432495117, -0.0342746265232563, -0.1388098448514938, 0.3756637275218964, 0.2406303733587265, 0.1881252676248550, -0.1518276780843735, 0.1872117221355438, 0.1484777033329010, 0.1825126409530640, -0.1781855672597885, 0.1650572419166565));
	res = max(res, ZEROS4) + float4(-0.5060276985168457, -1.3971502780914307, 0.7606850862503052, -0.5118398666381836) * min(res, ZEROS4);

	return compressLinear(res, -1.5, 3.5);
}
