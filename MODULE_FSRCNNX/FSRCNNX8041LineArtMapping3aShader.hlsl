// (FSRCNNX_x2_8-0-4-1_LA) mapping 3_1


cbuffer constants : register(b0) {
	int2 srcSize : packoffset(c0.x);
};


#define MAGPIE_INPUT_COUNT 2
#include "common.hlsli"


#define get(i, pos) uncompressTan(SampleInput(i, pos))


D2D_PS_ENTRY(main) {
	InitMagpieSampleInput();

	float2 leftTop = max(0, Coord(0).xy - Coord(0).zw);
	float2 rightBottom = min(maxCoord0.xy, Coord(0).xy + Coord(0).zw);

	float4 res = { 0.1563357263803482,-0.0187121629714966,-0.0126413907855749,0.1197946891188622 };
	res += mul(get(0, leftTop), float4x4(0.0248779058456421, 0.0970748737454414, -0.0710923895239830, -0.0502988137304783, -0.1513994187116623, 0.2118151038885117, -0.1060286536812782, -0.0017144688172266, -0.0556356199085712, -0.0478693507611752, 0.1046469956636429, 0.0019442490302026, -0.1099060326814651, 0.0196554642170668, -0.0393092185258865, -0.0131395589560270));
	res += mul(get(1, leftTop), float4x4(0.4478245079517365, -0.0910880789160728, -0.2786923944950104, -0.0162817053496838, 0.0112394141033292, -0.1194593086838722, 0.0425493344664574, -0.0044937161728740, -0.1628813296556473, -0.2678257226943970, 0.2309084981679916, 0.0530976355075836, -0.1750707328319550, -0.0064609451219440, -0.0241944380104542, 0.0247293189167976));
	res += mul(get(0, float2(leftTop.x, Coord(0).y)), float4x4(-0.0999718829989433, 0.2529200315475464, -0.2410994917154312, -0.0778252258896828, -0.1284751892089844, 0.0736103430390358, -0.0542359724640846, -0.0292810052633286, 0.0842959657311440, 0.1324738860130310, -0.1200775727629662, 0.0923810601234436, -0.3018241524696350, -0.0444923602044582, -0.2015913128852844, -0.0204973872750998));
	res += mul(get(1, float2(leftTop.x, Coord(0).y)), float4x4(-0.3240330517292023, -0.5515946745872498, -0.0859212949872017, 0.0462087914347649, -0.0053406502120197, -0.0506816878914833, 0.1402591317892075, 0.0343847945332527, -0.1610218435525894, 0.7799831628799438, -0.4482840299606323, 0.4723005294799805, -0.2119023054838181, 0.1128389388322830, -0.1832690685987473, -0.0362148694694042));
	res += mul(get(0, float2(leftTop.x, rightBottom.y)), float4x4(-0.0930702313780785, -0.0642902702093124, -0.0367766097187996, -0.0020038220100105, 0.0453414916992188, 0.0075245667248964, -0.0119760576635599, 0.0035134663339704, 0.1123304143548012, 0.1128236204385757, 0.0063381437212229, -0.0171416625380516, -0.1588087528944016, -0.2571538090705872, 0.2774460315704346, 0.0171892605721951));
	res += mul(get(1, float2(leftTop.x, rightBottom.y)), float4x4(-0.0579603239893913, 0.3495539724826813, -0.4717904627323151, -0.0042169657535851, -0.0763773098587990, -0.1721021682024002, 0.1467801630496979, -0.0172323398292065, -0.0802723765373230, -0.0116639221087098, 0.0178409330546856, -0.0121179902926087, -0.0710472315549850, -0.1480658054351807, 0.1912731230258942, 0.0008336952887475));
	res += mul(get(0, float2(Coord(0).x, leftTop.y)), float4x4(0.0445428267121315, -0.1481070518493652, 0.1304957717657089, -0.1157935336232185, -0.1166803613305092, -0.3920064568519592, 0.8788923621177673, 0.3384790122509003, -0.0278418567031622, -0.1011456921696663, -0.0513025075197220, -0.0748791247606277, -0.0502855703234673, -0.1696091145277023, -0.0049756630323827, -0.0209914986044168));
	res += mul(get(1, float2(Coord(0).x, leftTop.y)), float4x4(-0.1725586950778961, 0.1313660293817520, -0.3432282805442810, -0.0246748421341181, -0.0593904331326485, 0.1949618458747864, -0.2589366734027863, 0.0379127524793148, -0.0550928115844727, -0.0913493037223816, 0.1150950565934181, -0.1235521435737610, -0.0625528916716576, -0.3131158649921417, 0.4109992682933807, 0.0410865694284439));
	res += mul(get(0, Coord(0).xy), float4x4(0.8893174529075623, -0.0700975209474564, 0.7708584070205688, -0.2465052455663681, -0.1121069490909576, -0.5598245263099670, 0.7997139692306519, -0.5694547295570374, -0.1351616084575653, 0.1108073145151138, 0.7269443273544312, 0.1369582563638687, 0.6071134805679321, 0.8817817568778992, 0.0194139964878559, -0.2244683355093002));
	res += mul(get(1, Coord(0).xy), float4x4(-0.2949840426445007, -0.3180212676525116, -0.5362266302108765, 0.0656562000513077, -0.6400785446166992, -0.4476518630981445, -0.6344851851463318, 0.7187259793281555, -0.3846258223056793, 1.0990517139434814, -0.7282652258872986, -0.6530264616012573, 0.8294114470481873, 0.6079595088958740, 0.3271140158176422, 0.4062923491001129));
	res += mul(get(0, float2(Coord(0).x, rightBottom.y)), float4x4(-0.0373790934681892, -0.1651912927627563, 0.0589407421648502, 0.0622759014368057, 0.0095487469807267, 0.0824478641152382, -0.0216544214636087, 0.1070290282368660, -0.0805450007319450, -0.0367405600845814, 0.0055392896756530, 0.0046677836216986, 0.1806629896163940, 0.2809534966945648, 0.0341635458171368, 0.1274557113647461));
	res += mul(get(1, float2(Coord(0).x, rightBottom.y)), float4x4(0.3259792327880859, -0.3150677680969238, -0.2272015213966370, 0.0287732314318419, 0.0530966222286224, 0.3310768604278564, -0.2079527378082275, -0.1340134441852570, 0.0769909769296646, -0.2229669988155365, 0.1012685745954514, 0.0622584670782089, 0.1539722383022308, 0.2163516432046890, -0.1021269038319588, -0.0561319366097450));
	res += mul(get(0, float2(rightBottom.x, leftTop.y)), float4x4(-0.1077229678630829, -0.2074016332626343, 0.0913541764020920, 0.0391069389879704, 0.0848263725638390, -0.0416730083525181, 0.0603712275624275, 0.0457836911082268, 0.0035252417437732, 0.0004963557003066, 0.0027605029754341, 0.0254582706838846, -0.0146415829658508, 0.0273043140769005, 0.0692857503890991, 0.0091926595196128));
	res += mul(get(1, float2(rightBottom.x, leftTop.y)), float4x4(0.0692942291498184, -0.4098799824714661, 0.3745719194412231, -0.0331038050353527, -0.0513759665191174, 0.0989063531160355, -0.1431623697280884, -0.0274865441024303, 0.0244991369545460, -0.0112041812390089, 0.0523535087704659, 0.0222812052816153, -0.0314176008105278, 0.2347036451101303, -0.0928338095545769, -0.0338262394070625));
	res += mul(get(0, float2(rightBottom.x, Coord(0).y)), float4x4(0.3805117309093475, -0.1917886883020401, 0.2292910665273666, 0.3065188527107239, -0.2231798321008682, 0.2646720707416534, -0.1371945887804031, -0.0272636637091637, 0.1435333937406540, -0.0137438504025340, 0.0088603384792805, -0.0633594989776611, -0.1662645787000656, 0.2498313635587692, -0.2899549007415771, 0.0460192002356052));
	res += mul(get(1, float2(rightBottom.x, Coord(0).y)), float4x4(0.1833423078060150, 0.0624732412397861, -0.3103306889533997, -0.0102488445118070, 0.0073305973783135, -0.2617286443710327, 0.2580088973045349, -0.0416168905794621, 0.1506632268428802, -0.0574487410485744, 0.0778761878609657, 0.1702914088964462, -0.0307608898729086, 0.0848424360156059, -0.1303439885377884, -0.0837477520108223));
	res += mul(get(0, rightBottom), float4x4(0.0605936460196972, -0.0835580825805664, 0.0067690783180296, 0.0539834238588810, 0.0881687626242638, -0.0001589829771547, -0.0706917122006416, 0.0060382266528904, 0.1218314692378044, 0.0132934488356113, 0.0503435060381889, -0.0386124141514301, -0.1492055207490921, -0.0103553524240851, -0.0697906538844109, -0.0208332743495703));
	res += mul(get(1, rightBottom), float4x4(-0.2907077968120575, -0.1428615152835846, -0.1178332567214966, 0.0093302968889475, -0.0501379445195198, 0.1940260678529739, -0.0139665808528662, 0.0440400391817093, 0.0546711236238480, -0.0606320053339005, 0.0891899466514587, -0.0187927689403296, -0.0581561885774136, -0.0785671249032021, -0.0746953785419464, -0.0350385755300522));
	res = max(res, ZEROS4) + float4(0.0636819079518318, -0.0394099690020084, 0.0154740391299129, 1.4728027582168579) * min(res, ZEROS4);

	return compressTan(res);
}
