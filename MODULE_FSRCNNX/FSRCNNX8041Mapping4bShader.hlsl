// (FSRCNNX_x2_8-0-4-1) mapping 4_2


cbuffer constants : register(b0) {
	int2 srcSize : packoffset(c0.x);
};


#define MAGPIE_INPUT_COUNT 2
#include "common.hlsli"

#define get(i, pos) uncompressTan(SampleInput(i, pos))


D2D_PS_ENTRY(main) {
	InitMagpieSampleInput();

	float2 leftTop = max(0, Coord(0).xy - Coord(0).zw);
	float2 rightBottom = min(maxCoord0.xy, Coord(0).xy + Coord(0).zw);

	float4 res = { -0.1443098634481430,-0.1343899369239807,-0.0624338127672672,-0.1094277128577232 };
	res += mul(get(0, leftTop), float4x4(-0.0689977407455444, -0.1693786680698395, 0.0109281269833446, 0.0609922930598259, 0.0296908002346754, 0.1195700988173485, -0.0694077461957932, 0.0971287414431572, 0.0253518298268318, 0.1213042959570885, 0.0703809782862663, 0.0055739870294929, -0.1595942378044128, -0.1336689442396164, -0.0622441768646240, -0.0428023114800453));
	res += mul(get(1, leftTop), float4x4(0.0860001668334007, -0.0226618759334087, 0.1602241247892380, 0.0431661494076252, 0.1526461094617844, 0.2752982378005981, 0.0960300788283348, -0.0536719262599945, -0.0171773489564657, 0.0457364916801453, -0.0360932648181915, -0.0397153608500957, -0.0277090407907963, 0.0729821547865868, -0.0145150292664766, 0.0252893269062042));
	res += mul(get(0, float2(leftTop.x, Coord(0).y)), float4x4(-0.1407091915607452, -0.4007499516010284, -0.0302001200616360, -0.0606933943927288, -0.2960600554943085, -0.2263117432594299, 0.0721478462219238, -0.4578711986541748, 0.0960150733590126, -0.1606502830982208, 0.2444226741790771, 0.0000882153908606, 0.1472496986389160, 0.3256779909133911, -0.2132861614227295, 0.0339313484728336));
	res += mul(get(1, float2(leftTop.x, Coord(0).y)), float4x4(-0.1477648764848709, -0.1487885862588882, -0.1973863691091537, 0.0717295333743095, 0.0843430235981941, 0.6259996294975281, -0.1214931011199951, -0.1274987608194351, 0.2359549105167389, 0.3002171218395233, -0.0825233608484268, -0.0157950688153505, 0.0706149637699127, 0.1762917637825012, -0.0611497573554516, -0.0859689489006996));
	res += mul(get(0, float2(leftTop.x, rightBottom.y)), float4x4(0.0174895934760571, -0.0567042417824268, 0.0409146919846535, 0.0258173532783985, 0.1421577036380768, 0.1234543323516846, -0.1721662431955338, 0.1492216140031815, 0.1100751459598541, 0.0501539446413517, 0.1100447699427605, -0.1086079254746437, -0.0608497932553291, 0.0087817469611764, 0.0714464113116264, -0.1285197436809540));
	res += mul(get(1, float2(leftTop.x, rightBottom.y)), float4x4(-0.0017177806003019, -0.1463395059108734, -0.1085453778505325, 0.1650195866823196, 0.0813829153776169, 0.1102061793208122, -0.0578421875834465, -0.0232036896049976, -0.1239888817071915, 0.0155465165153146, 0.1079114526510239, -0.0420837886631489, -0.0775837749242783, 0.0148941157385707, -0.0502299368381500, -0.0654754191637039));
	res += mul(get(0, float2(Coord(0).x, leftTop.y)), float4x4(0.0918162539601326, 0.0440697595477104, -0.0515748932957649, 0.0417411290109158, 0.0353216230869293, 0.1535954177379608, 0.0439723692834377, -0.1288845241069794, 0.1076577678322792, -0.1306740194559097, 0.0715952813625336, -0.0681907683610916, -0.3798767924308777, 0.1023928597569466, -0.0970670804381371, 0.0077168666757643));
	res += mul(get(1, float2(Coord(0).x, leftTop.y)), float4x4(0.0634560957551003, -0.0550306066870689, 0.2073986232280731, 0.0520241297781467, 0.1162287592887878, -0.2218665480613708, 0.3199682831764221, 0.0606246069073677, -0.0058511858806014, -0.0667045339941978, -0.0449917949736118, 0.0707788690924644, -0.3323366343975067, -0.0763893201947212, -0.0997853428125381, -0.1181001588702202));
	res += mul(get(0, Coord(0).xy), float4x4(-0.3101258873939514, 0.2616009712219238, 0.0584651045501232, 0.1656491309404373, -0.0069236233830452, 0.2573371529579163, -0.1793291717767715, -0.2718756198883057, 0.0953581258654594, 0.0524105131626129, 0.1183085516095161, 0.0583294369280338, 0.5036848187446594, -0.5763167142868042, -0.2119628041982651, -0.3140562772750854));
	res += mul(get(1, Coord(0).xy), float4x4(-0.2497755438089371, -0.0146329319104552, -0.2741575539112091, 0.2459975033998489, 0.3562706708908081, -0.6528629064559937, -0.4287456274032593, 0.2055913358926773, 0.1739019453525543, -0.3855968713760376, -0.0958273336291313, -0.7066691517829895, 0.2365748286247253, -0.3046728968620300, -0.2590373754501343, -0.0496727414429188));
	res += mul(get(0, float2(Coord(0).x, rightBottom.y)), float4x4(-0.0844531357288361, -0.0321611948311329, -0.0951840654015541, 0.0577518045902252, -0.1606003493070602, 0.2776086628437042, -0.1355003118515015, -0.0880064144730568, -0.1277643740177155, -0.0514567233622074, 0.1522682905197144, -0.1040910631418228, -0.2767944037914276, -0.1452194601297379, 0.0089118303731084, 0.0231996178627014));
	res += mul(get(1, float2(Coord(0).x, rightBottom.y)), float4x4(0.2603267133235931, 0.0167464651167393, -0.2064073234796524, 0.1782064288854599, 0.4890212416648865, 0.0559245310723782, 0.1221160590648651, -0.0202587731182575, -0.4056585729122162, -0.1839511841535568, 0.2775998413562775, 0.0024275144096464, -0.2624500989913940, -0.0619418807327747, 0.0153478365391493, 0.0123427547514439));
	res += mul(get(0, float2(rightBottom.x, leftTop.y)), float4x4(0.0816635638475418, -0.0134946266189218, 0.0594766475260258, -0.0551253929734230, 0.0134431896731257, -0.0652195811271667, -0.0563635528087616, -0.0066532371565700, -0.0004114551993553, 0.0105680683627725, 0.1324467360973358, 0.0467248968780041, 0.0301312971860170, -0.1073397025465965, -0.0363437235355377, -0.0474153012037277));
	res += mul(get(1, float2(rightBottom.x, leftTop.y)), float4x4(0.0199097190052271, 0.0901319086551666, 0.0448978282511234, 0.0505443066358566, 0.0438878424465656, -0.0494784042239189, 0.0724927335977554, -0.0070675504393876, -0.0012125011999160, 0.0295279901474714, 0.0705125033855438, 0.0555334389209747, -0.0403393507003784, -0.1271172016859055, 0.0017914215568453, 0.1462216079235077));
	res += mul(get(0, float2(rightBottom.x, Coord(0).y)), float4x4(-0.2827299833297729, 0.2052399665117264, 0.0042732120491564, -0.3969024717807770, -0.0782120972871780, 0.1960176974534988, -0.0675340741872787, 0.0027962317690253, 0.0516129024326801, -0.0352642722427845, 0.0546326488256454, 0.0065340655855834, -0.1062376946210861, 0.1364430636167526, -0.0536947809159756, 0.2098117172718048));
	res += mul(get(1, float2(rightBottom.x, Coord(0).y)), float4x4(0.0045875865034759, 0.2162927240133286, -0.2158576399087906, -0.0047327815555036, 0.1251590698957443, 0.1279677897691727, -0.1188964918255806, 0.0328494384884834, 0.0076038073748350, -0.0561547242105007, 0.0335608273744583, 0.4332321286201477, 0.0021786799188703, 0.0844521671533585, -0.2102309316396713, -0.0189208015799522));
	res += mul(get(0, rightBottom), float4x4(0.0933093801140785, 0.1548244059085846, -0.0598701611161232, 0.0357220247387886, -0.1141726672649384, 0.0536412484943867, -0.0159156844019890, -0.0445508137345314, 0.1883231997489929, -0.1547038406133652, 0.0530619807541370, 0.0059371814131737, 0.0602529086172581, -0.0435577929019928, 0.0083390390500426, 0.0191930737346411));
	res += mul(get(1, rightBottom), float4x4(-0.0351041629910469, 0.2119503468275070, -0.0841927304863930, 0.0079463515430689, 0.0683520361781120, -0.1657009869813919, 0.0611055232584476, -0.0063667562790215, 0.0330024957656860, -0.1810818463563919, 0.0872574150562286, 0.1485669612884521, -0.1305806934833527, 0.0041402997449040, 0.0223289318382740, -0.0141495745629072));
	res = max(res, ZEROS4) + float4(0.5769761204719543, 0.1716064810752869, -0.0821026712656021, 0.2092144042253494) * min(res, ZEROS4);

	return compressTan(res);
}
