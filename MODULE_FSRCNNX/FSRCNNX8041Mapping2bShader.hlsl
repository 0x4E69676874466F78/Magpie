// (FSRCNNX_x2_8-0-4-1) mapping 2_2


cbuffer constants : register(b0) {
	int2 srcSize : packoffset(c0.x);
};


#define MAGPIE_INPUT_COUNT 2
#include "FSRCNNX8041.hlsli"

#define get0(pos) uncompressTan(SampleInput(0, pos))
#define get1(pos) uncompressLinear(SampleInput(1, pos), -4, 4.5)


D2D_PS_ENTRY(main) {
	InitMagpieSampleInput();

	float2 leftTop = GetCheckedOffPos(0, float2(-1, -1));
	float2 rightBottom = GetCheckedOffPos(0, float2(1, 1));

	float4 res = { -0.0448397286236286,-0.1649267971515656,-0.1192543581128120,-0.0061073559336364 };
	res += mul(get0(leftTop), float4x4(0.0724840760231018, -0.0480341166257858, -0.1082391515374184, -0.1447021961212158, 0.0723197236657143, 0.0481830574572086, 0.0009448126656935, 0.0353565886616707, -0.0653375908732414, 0.0029647622723132, -0.0016588598955423, -0.2075651884078979, 0.0403469167649746, 0.3929971158504486, 0.0342363268136978, 0.1427230089902878));
	res += mul(get1(leftTop), float4x4(-0.0743464827537537, 0.1844420731067657, 0.0256296340376139, -0.2808582782745361, 0.0351609662175179, 0.3277008235454559, -0.0205841138958931, -0.5355809330940247, 0.0681906566023827, 0.2058052271604538, -0.0479847639799118, -0.3735262751579285, -0.0261550359427929, -0.1148884072899818, -0.2329017966985703, 0.0728458985686302));
	res += mul(get0(float2(leftTop.x, Coord(0).y)), float4x4(-0.1236097738146782, 0.1251334398984909, -0.1339431256055832, 0.0198749266564846, -0.1325920224189758, -2.2431972026824951, -0.0680834427475929, -0.5671764612197876, -0.3431925177574158, -0.0983135104179382, -0.2207138091325760, -0.2374879121780396, 0.0127309206873178, 1.3076044321060181, 0.0848151743412018, -0.1928595900535583));
	res += mul(get1(float2(leftTop.x, Coord(0).y)), float4x4(-0.0471093133091927, -0.1513628512620926, -0.0134263765066862, -0.1519252359867096, -0.5260242223739624, 0.2291621714830399, 0.4088975787162781, -0.4315340518951416, 0.0933236032724380, -1.0386694669723511, 0.0015958193689585, -0.2737887501716614, -0.0246253963559866, -0.2722961604595184, -0.1770633459091187, -0.2291279733181000));
	res += mul(get0(float2(leftTop.x, rightBottom.y)), float4x4(-0.0017552347853780, 0.1903935521841049, -0.0740704238414764, -0.0917679518461227, 0.0323882810771465, -0.3029108047485352, 0.0532565414905548, -0.0651542618870735, 0.4868686199188232, 0.8539272546768188, 0.4151960313320160, 0.2619662582874298, -0.0413270294666290, 0.1404227763414383, 0.1027320474386215, 0.3274228572845459));
	res += mul(get1(float2(leftTop.x, rightBottom.y)), float4x4(0.1828346252441406, 0.0274682324379683, -0.1169882863759995, 0.0327291004359722, 0.1786244213581085, -0.6569546461105347, -0.0609031207859516, -0.1676601022481918, -0.1481092721223831, 0.2889067530632019, 0.1246089115738869, 0.2203597426414490, -0.0366856977343559, 0.1539470851421356, 0.0069492300972342, -0.1544002443552017));
	res += mul(get0(float2(Coord(0).x, leftTop.y)), float4x4(0.2073992937803268, -0.0717074573040009, -0.0196173377335072, -0.0956910699605942, 0.0728898122906685, 0.0484567955136299, 0.3063069283962250, -0.3200540542602539, 0.0291527546942234, -0.0265460256487131, 0.1168476045131683, -0.2479970753192902, 0.1224220171570778, 0.0745823010802269, 0.1868897676467896, -0.1958049237728119));
	res += mul(get1(float2(Coord(0).x, leftTop.y)), float4x4(0.0019954447634518, -0.0225235987454653, 0.0812198966741562, 0.0295672398060560, -0.2016931176185608, -0.2239151000976562, -0.2481262385845184, -0.2381946444511414, -0.0520484372973442, -0.1200495883822441, 0.2121954560279846, -0.1573531329631805, -0.0198472067713737, 0.1001087054610252, -0.1084884032607079, -0.3126969039440155));
	res += mul(get0(Coord(0).xy), float4x4(0.3838330209255219, 0.1678779572248459, 0.6496244072914124, 0.3783606290817261, -0.2198582738637924, -0.2351343184709549, -0.2852248847484589, 0.6310021877288818, 0.8083020448684692, 0.0039323624223471, -0.0901831910014153, 0.0797894075512886, -0.2271467447280884, 0.7082978487014771, 0.1513756662607193, 0.2188975960016251));
	res += mul(get1(Coord(0).xy), float4x4(-0.2871031761169434, 0.2316448241472244, 0.4947948157787323, 0.3308620452880859, -0.0623455122113228, -0.1314185708761215, -0.2664661705493927, 0.8725078701972961, 0.4541083276271820, 0.1433589160442352, -1.1269453763961792, 0.6427971124649048, -0.1016561388969421, 0.3418317139148712, -0.0991155728697777, -1.0508837699890137));
	res += mul(get0(float2(Coord(0).x, rightBottom.y)), float4x4(-0.2179604172706604, 0.1258949041366577, -0.1155700981616974, -0.0536149404942989, -0.0140614463016391, -0.0091438721865416, -0.0501774959266186, -0.3570724725723267, -0.5832386016845703, 0.2004123181104660, 0.2986239194869995, -0.8139168024063110, 0.0142666567116976, 0.0681498944759369, 0.1293468028306961, -0.1001938357949257));
	res += mul(get1(float2(Coord(0).x, rightBottom.y)), float4x4(0.1952836811542511, -0.3092494010925293, 0.3063779771327972, 0.1934849917888641, 0.0746696740388870, -0.3533902466297150, -0.1269576102495193, -0.2237875163555145, 0.2470717132091522, -0.2640363574028015, -0.2862776815891266, 0.1740108281373978, -0.0963631942868233, 0.2631850540637970, 0.0400718413293362, -0.3590607047080994));
	res += mul(get0(float2(rightBottom.x, leftTop.y)), float4x4(-0.5299927592277527, 0.0979989692568779, 0.1666737496852875, -0.1547524333000183, -0.0043443185277283, 0.1540203243494034, 0.0594348423182964, -0.0167275425046682, -0.1043610796332359, 0.0504250898957253, 0.0456700921058655, 0.2525034546852112, 0.2241353541612625, -0.1678503304719925, 0.1532667279243469, 0.2901742458343506));
	res += mul(get1(float2(rightBottom.x, leftTop.y)), float4x4(0.0998796448111534, 0.0385462641716003, -0.0762400180101395, -0.1255892217159271, 0.0281430184841156, -0.0304958485066891, -0.1440480053424835, -0.1001605167984962, -0.2257689833641052, 0.2056092917919159, 0.0248535349965096, -0.1383949518203735, -0.0951708629727364, 0.0997417271137238, 0.0275330394506454, -0.5728432536125183));
	res += mul(get0(float2(rightBottom.x, Coord(0).y)), float4x4(0.4256163835525513, 0.1745115518569946, -0.2409395426511765, 0.3139856457710266, -0.0036795330233872, 0.1819283962249756, -0.0864531323313713, 0.0102691333740950, -0.3397279977798462, 0.1107075437903404, -0.0035228815395385, -0.2207705229520798, -0.1779139339923859, -0.2106117755174637, 0.0352664291858673, 0.3615589439868927));
	res += mul(get1(float2(rightBottom.x, Coord(0).y)), float4x4(-0.0345224253833294, -0.0669926702976227, 0.0907212942838669, -0.3758732676506042, -0.0452554710209370, -0.1134464666247368, -0.0358871109783649, -0.1858227252960205, -0.0233245138078928, -0.0495684742927551, 0.1976234614849091, -0.1165761798620224, -0.0340447537600994, 0.1095624342560768, 0.0110175255686045, -0.8269239664077759));
	res += mul(get0(rightBottom), float4x4(-0.1379280686378479, 0.1004267781972885, 0.0723998174071312, -0.1510958224534988, 0.0610648579895496, 0.0451720170676708, -0.0231927260756493, -0.0251553766429424, 0.2306085377931595, 0.1033207178115845, -0.1316205114126205, 0.1130664870142937, -0.0458516106009483, -0.1152514070272446, -0.0088650323450565, -0.0214479379355907));
	res += mul(get1(rightBottom), float4x4(-0.0545783303678036, -0.0620098188519478, 0.0347074456512928, 0.1096799224615097, 0.0036664425861090, -0.0413107499480247, 0.1443250179290771, -0.1161036714911461, -0.0061624986119568, -0.0252977479249239, 0.3230019211769104, -0.2536626160144806, -0.0565439648926258, 0.0827583819627762, -0.0071726376190782, -0.1983329951763153));
	res = max(res, ZEROS4) + float4(-0.6312188506126404, -0.1215368881821632, 0.2487443536520004, 0.4051703512668610) * min(res, ZEROS4);

	return compressTan(res);
}
